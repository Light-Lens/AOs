            int cursor_pos = 0;
            while (true)
            {
                ConsoleKeyInfo keyInfo = Console.ReadKey(true);

                if (keyInfo.Key == ConsoleKey.Enter)
                {
                    Console.WriteLine();
                    if (!string.IsNullOrEmpty(CMD))
                        Console.WriteLine($"You entered: {CMD}");

                    CMD = "";
                    cursor_pos = 0;
                    Console.Write(Prompt);
                }

                else if (keyInfo.Key == ConsoleKey.LeftArrow)
                {
                    if (cursor_pos > 0)
                    {
                        cursor_pos--;
                        Console.Write("\b");
                    }
                }
                else if (keyInfo.Key == ConsoleKey.RightArrow)
                {
                    if (cursor_pos < CMD.Length)
                    {
                        cursor_pos++;
                        Console.Write(CMD[cursor_pos - 1]);
                    }
                }
                else if (keyInfo.Key == ConsoleKey.Backspace)
                {
                    if (cursor_pos > 0)
                    {
                        CMD = CMD.Remove(cursor_pos - 1, 1);
                        cursor_pos--;
                        Console.Write("\b" + CMD.Substring(cursor_pos) + " ");
                        Console.SetCursorPosition(Console.CursorLeft - CMD.Length + cursor_pos, Console.CursorTop);
                    }
                }
                else if (!char.IsControl(keyInfo.KeyChar))
                {
                    CMD = CMD.Insert(cursor_pos, keyInfo.KeyChar.ToString());
                    cursor_pos++;
                    Console.Write(CMD.Substring(cursor_pos - 1));
                    Console.SetCursorPosition(Console.CursorLeft - CMD.Length + cursor_pos, Console.CursorTop);
                }
                else if (keyInfo.Key == ConsoleKey.Escape)
                {
                    CMD = "";
                    cursor_pos = 0;
                    Console.Write(new string(' ', Console.WindowWidth - Prompt.Length));
                    Console.SetCursorPosition(Prompt.Length, Console.CursorTop);
                }
            }